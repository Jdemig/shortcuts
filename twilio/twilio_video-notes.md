# Twilio - Video Notes

"Everything you need to build with WebRTC." - Twilio

**Features**

* One-to-one or Multi-party
  + One-to-One
    - End-to-end encryption
    - Up to 10 Participants
  + Multi-party
    - Recording
    - Up to 50 Participants
* Recording
* REST orchestration
* Webhook notifications
* Room-based access control
* Management console
* Screen sharing
* Client-side UI control
* DataTrack
* Low latency media routing

See https://www.twilio.com/video and
https://www.twilio.com/docs/programmable-video for details.


## JavaScript Platform

See https://www.twilio.com/docs/api/video/javascript and
https://media.twiliocdn.com/sdk/js/video/v1/docs for details.

**Initial Onetime Setup**

* Install the SDK: `npm install --save twilio-video`
* Create an API Key: See https://www.twilio.com/console/video/runtime/api-keys

**General Steps**

The general steps to create a video/audio app is as follows:

1. Generate an Access Token
2. Connect to a room and start listening for room events
3. When new participants connect, start listening for participant events

**Generating an Access Token**

An access token is expected to be generated by one of your servers, not a Twilio
server.

See https://github.com/TwilioDevEd/video-access-token-server-node for a video
access token server for Node.js.  The basics are repeated below.

```js
// server.js
import dotenv from 'dotenv';
import express from 'express';
import Twilio from 'twilio';

// Load environment files for access to configuration Values.
dotenv.load();

const AccessToken = Twilio.jwt.AccessToken;
const VideoGrant = AccessToken.VideoGrant;

const app = express();

...

/**
 * Generate an Access Token for a chat application user - it generates a random
 * username for the client requesting a token, and takes a device ID as a query
 * parameter.
 */
app.get('/api/token', function (request, response) {
  const identity = request.query.identity || 'identity';
  const room = request.query.room;

  const opts = {
    ttl: 3600, // Seconds
    identity: identity,
    nbf: Date.now() - (60 * 1000),
  };
  let token = new AccessToken(
    process.env.TWILIO_ACCOUNT_SID,
    process.env.TWILIO_API_KEY,
    process.env.TWILIO_API_SECRET,
    opts
  );

  // Grant the access token Twilio Video capabilities.
  let grant = new VideoGrant({
    room: room,
  });
  token.addGrant(grant);

  // Add other grants depending on your application

  // Serialize the token to a JWT string and include it in a JSON response.
  let tokenJwt = token.toJwt();
  response.send(tokenJwt);
});
